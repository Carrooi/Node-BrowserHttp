// Generated by CoffeeScript 1.7.1
(function() {
  var Http, Request, original;

  Http = require('../Http');

  Request = require('./Request');

  original = Http.createRequest;

  Http.receive = function(sendData, headers, status) {
    if (sendData == null) {
      sendData = '';
    }
    if (headers == null) {
      headers = {};
    }
    if (status == null) {
      status = 200;
    }
    return Http.createRequest = function(url, type, data, jsonp, jsonPrefix) {
      var request;
      request = new Request(url, type, data, jsonp, jsonPrefix);
      request.on('afterSend', function() {
        var name, value;
        if (typeof headers['content-type'] === 'undefined') {
          headers['content-type'] = 'text/plain';
        }
        for (name in headers) {
          value = headers[name];
          request.xhr.setResponseHeader(name, value);
        }
        return request.xhr.receive(status, sendData);
      });
      return request;
    };
  };

  Http.receiveError = function(err) {
    return Http.createRequest = function(url, type, data, jsonp, jsonPrefix) {
      var request;
      request = new Request(url, type, data, jsonp, jsonPrefix);
      request.on('afterSend', function() {
        return request.xhr.receiveError(err);
      });
      return request;
    };
  };

  Http.restore = function() {
    return Http.createRequest = original;
  };

  module.exports = Http;

}).call(this);
